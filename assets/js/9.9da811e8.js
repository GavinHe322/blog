(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{209:function(t,s,e){"use strict";e.r(s);var a=e(0),n=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("blockquote",[e("h2",{attrs:{id:"jenkins"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#jenkins"}},[t._v("#")]),t._v(" Jenkins")])]),t._v(" "),e("h3",{attrs:{id:"概念"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#概念"}},[t._v("#")]),t._v(" "),e("strong",[t._v("概念")])]),t._v(" "),e("ul",[e("li",[e("p",[t._v("Jenkins是一款开源 CI&CD 软件，用于自动化各种任务，包括构建、测试和部署软件。")])]),t._v(" "),e("li",[e("p",[t._v("Jenkins 支持各种运行方式，可通过系统包、Docker 或者通过一个独立的 Java 程序。")])])]),t._v(" "),e("h3",{attrs:{id:"为什么要学"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#为什么要学"}},[t._v("#")]),t._v(" "),e("strong",[t._v("为什么要学")])]),t._v(" "),e("ul",[e("li",[t._v("公司在用")]),t._v(" "),e("li",[t._v("稍微好一点的岗位职责像"),e("code",[t._v("jenkins")]),t._v("之类 (持续集成、自动部署) 的，基本都是多多少少是会提到的。")]),t._v(" "),e("li",[t._v("传统的做法，在服务器初始一个 "),e("code",[t._v("git")]),t._v(" 仓库，然后每次代码更新后，人工手动去拉去，次数多了也就烦了，而这些每次只需在项目开始前配置一遍 "),e("code",[t._v("jenkins")]),t._v(" 之后所有的人工操作都不需要管了。(ps: 有问题甩锅给 "),e("code",[t._v("jenkins")]),t._v(" 就行了[呲牙])")])]),t._v(" "),e("h3",{attrs:{id:"前置任务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#前置任务"}},[t._v("#")]),t._v(" "),e("strong",[t._v("前置任务")])]),t._v(" "),e("ul",[e("li",[e("code",[t._v("centOs")]),t._v(" 服务器")]),t._v(" "),e("li",[e("code",[t._v("git")]),t._v("、 "),e("code",[t._v("linux")]),t._v("、"),e("code",[t._v("shell")]),t._v(" 基础就行。")]),t._v(" "),e("li",[e("code",[t._v("nginx")]),t._v("基本配置。")])]),t._v(" "),e("h3",{attrs:{id:"开篇准备"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#开篇准备"}},[t._v("#")]),t._v(" "),e("strong",[t._v("开篇准备")])]),t._v(" "),e("p",[e("strong",[t._v("初始一个 "),e("code",[t._v("vuecli")]),t._v(" 项目，访问如下")])]),t._v(" "),e("p",[e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/11/23/16e97572df9eaafb?w=3318&h=1108&f=png&s=156601",alt:""}}),t._v(" "),e("strong",[t._v("在 "),e("code",[t._v("github")]),t._v(" 创建仓库")])]),t._v(" "),e("p",[e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/11/23/16e975c831902e62?w=2488&h=1560&f=png&s=447256",alt:""}})]),t._v(" "),e("p",[e("strong",[t._v("配置 "),e("code",[t._v("github webhook")])])]),t._v(" "),e("p",[e("code",[t._v("http://ip:8080/github-webhook/")])]),t._v(" "),e("p",[e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/11/23/16e97f623c208cc2?w=2264&h=1600&f=png&s=353667",alt:""}})]),t._v(" "),e("blockquote",[e("h2",{attrs:{id:"目录"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#目录"}},[t._v("#")]),t._v(" "),e("strong",[t._v("目录")])])]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"}},[t._v("jenkins 环境搭建")])]),t._v(" "),e("li",[e("a",{attrs:{href:"#%E6%96%B0%E5%BB%BA%E4%BB%BB%E5%8A%A1"}},[t._v("新建 jenkins 任务")])]),t._v(" "),e("li",[e("a",{attrs:{href:"#nginx"}},[t._v("nginx访问")])])]),t._v(" "),e("h3",{attrs:{id:"环境搭建"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#环境搭建"}},[t._v("#")]),t._v(" 环境搭建")]),t._v(" "),e("p",[t._v("登录服务器")]),t._v(" "),e("p",[e("strong",[t._v("安装"),e("code",[t._v("java")]),t._v("依赖")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("yum install java\n")])])]),e("p",[e("strong",[t._v("使用 "),e("code",[t._v("wget")]),t._v(" 添加"),e("code",[t._v("jenkins源")])])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("wget -O /etc/yum.repos.d/jenkins.repo http://pkg.jenkins-ci.org/redhat/jenkins.repo\nrpm --import https://jenkins-ci.org/redhat/jenkins-ci.org.key\n")])])]),e("p",[e("strong",[t._v("安装之后使用 "),e("code",[t._v("yum")]),t._v(" 命令就能下载了。")])]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("yum install jenkins\n")])])]),e("p",[e("strong",[t._v("jenkins 修改权限 端口之类的，在该位置")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("vim /etc/sysconfig/jenkins\n")])])]),e("ul",[e("li",[t._v("JENKINS_PORT -> jenkins的"),e("strong",[t._v("启动端口")]),t._v("，默认"),e("code",[t._v("8080")])]),t._v(" "),e("li",[t._v("JENKINS_USER -> jenkins 用户，修改为"),e("code",[t._v("root")])])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('// 这里我将 JENKINS_USER 修改为 root 用户了。\nJENKINS_USER="root"\n')])])]),e("p",[e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/11/23/16e977fff4cdd93a?w=932&h=262&f=png&s=128287",alt:""}})]),t._v(" "),e("p",[e("strong",[t._v("使用 "),e("code",[t._v("chown")]),t._v("给 "),e("code",[t._v("jenkins")]),t._v(" 指定所有权")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("chown -R root:root /var/lib/jenkins\nchown -R root:root /var/cache/jenkins\nchown -R root:root /var/log/jenkins\n")])])]),e("p",[e("strong",[t._v("启动 "),e("code",[t._v("jenkins")])])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("service jenkins restart\n")])])]),e("p",[t._v("看到 ok 即可")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/11/23/16e9781cdc4d0d20?w=1022&h=116&f=png&s=56478",alt:""}})]),t._v(" "),e("p",[e("strong",[t._v("访问"),e("code",[t._v("jenkins")])])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("ip地址 + 8080\n")])])]),e("p",[t._v("首次访问是这样子的(官网图).")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/11/23/16e9785b24b1c66d?w=990&h=679&f=jpeg&s=80191",alt:""}})]),t._v(" "),e("p",[t._v("这张图红色圈起来的替换成你页面显示的")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("cat /val/jenkins_home/xxxx/xxx\n")])])]),e("p",[t._v("然后将显示的复制到 输入框后，点击下一步即可。")]),t._v(" "),e("p",[e("strong",[t._v("然后到安装插件页面")])]),t._v(" "),e("p",[e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/11/23/16e9788ee23d7956?w=992&h=562&f=webp&s=18674",alt:""}}),t._v("\n我这里是点击的 安装推荐插件 选项。")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/11/23/16e978ab3e4fa7fb?w=1049&h=711&f=webp&s=15688",alt:""}}),t._v("\n等待即可，有点漫长 loading...\n"),e("br")]),t._v(" "),e("p",[e("strong",[t._v("创建用户")])]),t._v(" "),e("p",[e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/11/23/16e978ce5d84f03b?w=997&h=440&f=webp&s=8020",alt:""}}),t._v(" "),e("strong",[t._v("然后到这里 jenkins 就安装完毕了，点击开始使用。")]),t._v(" "),e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/11/23/16e978d39e1efa02?w=1002&h=287&f=webp&s=6772",alt:""}}),t._v(" "),e("br")]),t._v(" "),e("h3",{attrs:{id:"新建任务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#新建任务"}},[t._v("#")]),t._v(" 新建任务")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/11/23/16e97a483911d4c4?w=2892&h=1716&f=png&s=468248",alt:""}})]),t._v(" "),e("p",[e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/11/23/16e97a72f3a5eceb?w=2380&h=1740&f=png&s=297530",alt:""}}),t._v("\n构建触发器，就是监听 "),e("code",[t._v("github")]),t._v(" 的 "),e("code",[t._v("webhook")]),t._v("，如有新的 "),e("code",[t._v("push")]),t._v(" 后 重新构建。\n"),e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/11/23/16e97f13c9584b74?w=2218&h=1274&f=png&s=224857",alt:""}}),t._v(" "),e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/11/23/16e97a8ef003bf27?w=2480&h=1676&f=png&s=233063",alt:""}}),t._v("\n此时保存即可")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/11/23/16e97ab1c9f352c8?w=1462&h=1328&f=png&s=273397",alt:""}}),t._v("\n点击那个 w 列的🌞(太阳)，这里是构建的描述，\n如果构建失败的话，你可以根据这里的提示定位问题。")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/11/23/16e97ae9d2cc2f2f?w=2218&h=1166&f=png&s=447670",alt:""}}),t._v("\n这里我当时蒙蔽了一下，我就在想构建后的文件去哪里了，我该怎么访问?")]),t._v(" "),e("p",[e("strong",[t._v("构建后的存放地址")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("cd /var/lib/jenkins/workspace\n")])])]),e("p",[e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/11/23/16e97c2d25d7766e?w=666&h=198&f=png&s=74372",alt:""}}),t._v(" "),e("strong",[t._v("此时我们在去修改一下配置信息中的 "),e("code",[t._v("shell")])])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("node -v\nnpm -v\nnpm install\nnpm run build\n")])])]),e("p",[t._v("发现构建失败??")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/11/23/16e97c80f626adc0?w=2060&h=1128&f=png&s=412669",alt:""}}),t._v("\n不过没关系")]),t._v(" "),e("p",[t._v("我们进入全局设置的插件管理")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/11/23/16e97d00ff0d17fe?w=2416&h=664&f=png&s=138227",alt:""}}),t._v("\n下载完后，我们去全局配置管理，发现对了 一个 NodeJs 选项。")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/11/23/16e97dba6c7d3eea?w=2456&h=1556&f=png&s=613978",alt:""}})]),t._v(" "),e("p",[e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/11/23/16e97df209f5c541?w=1890&h=1514&f=png&s=252702",alt:""}}),t._v("\n啊 千辛万苦，终于看到 我们最爱的 "),e("code",[t._v("dist")]),t._v(" 文件了，这里你的 shell 命令可以自动拓展，如移动到其他位置。\n"),e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/11/23/16e97e71a410c751?w=2360&h=1092&f=png&s=353467",alt:""}})]),t._v(" "),e("h3",{attrs:{id:"nginx"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#nginx"}},[t._v("#")]),t._v(" nginx")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("cd /etc/nginx/conf.d\nvim test-jenkins.conf\n\nserver {\n      listen 8000; # 监听端口\n      server_name _;\n      location / {\n        # 这里我这里指向 jenkins 构建的目录，也可以在构建时的 shell 将文件移动要其他地方。\n        root  /var/lib/jenkins/workspace/test-jenkins/dist;\n        try_files $uri $uri/ index.html;\n      }\n\n      error_page 500 502 503 504 /50x.html;\n      location = /50x.html {\n        root /usr/share/nginx/html;\n      }\n}\n")])])]),e("p",[t._v("**然后打开就 ip:8000 就能访问了。")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/11/23/16e9804b2bf8f65f?w=2890&h=778&f=png&s=121151",alt:""}})]),t._v(" "),e("h3",{attrs:{id:"last"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#last"}},[t._v("#")]),t._v(" "),e("strong",[t._v("last")])]),t._v(" "),e("p",[t._v("我们在本地 重新 "),e("code",[t._v("push")]),t._v(" ，看下这个页面会不会变。")]),t._v(" "),e("p",[t._v("我们刷新页面如果发现 "),e("code",[t._v("404 Not Found")]),t._v(" 不要方，"),e("code",[t._v("npm run build")]),t._v(" 会先删除 "),e("code",[t._v("dist")]),t._v(" 文件。")]),t._v(" "),e("p",[e("strong",[t._v("访问如下就说明我们基本配置全部完成了，")])]),t._v(" "),e("p",[e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/11/23/16e980b30c15e52b?w=1972&h=426&f=png&s=83982",alt:""}})])])}),[],!1,null,null,null);s.default=n.exports}}]);