# 代码迁移
时间: 2019-11-20
******

## 目前项目

- 最新的 element 脚手架是基于 vuecli 3.5+ 版本的。Webpack 4.+版本，其他 npm 包都升级为较新版本。
- 去掉了 webpack.dev.conf.js，之类的配置，改为用vuecli 推荐的环境变量。
- 启动速度、打包速度有所提升。
- 重构了一些代码，如菜单权限、权限管理页面表格展示，去掉了原先 treeTable + 递归重排数据结构 的写法。
- 原先的初始样式并不多，现在在 ```global.scss``` 增加了一些新的初始样式。


## 遇到的问题

- 迁移代码后，根据报错和提示安装以前用到的 npm 包，但是过程中遇到没有提示的错误，后来改为小部分小部分的迁移。
- 本来增加了 eslint 代码检查，但是由于原先的代码报错和警告太多，就关闭了。
- ```vuecli 3.5+``` 环境变量是以 ```VUE_APP``` 开头的，所有原先的 ```process.env.BASE_API``` 变量需要增加 ```VUE_APP``` 前缀。
- 以为左边的菜单层级是升级导致，结果是原先写死了 100000，已修改为 1000
  - 中间编辑角色的菜单 和 权限 背景颜色可能是之前修改样式影响到的，已修复。 
- 走到权限管理时，遇到 ```there’s nested data, rowKey is required``` 错误，
  - Element嵌套表格需要指定的 row-key=’id’，但是，设置后，出现怪异情况，最后确认是 element 自身版本问题，已降级为 2.7 以下版本
- 航线预测	
  - Inv_date 已经通过 prop 传给子组件了， 然后这里注释掉的写法是调用子组件的方法又重新传值给子组件，会报一个 this prop since will be overwitten
- ```pdf``` 打包，需要重新配置 ```webpack``` 中 ```file-loader``` 的规则。


## 清除无用目录 及 package.json 中没有用到的包.
